<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìˆ«ì ë§íˆê¸° ê²Œì„ (ì €ì¥ ê¸°ëŠ¥ í¬í•¨)</title>
    <style>
        /* CSS ìŠ¤íƒ€ì¼ */
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
            background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); /* ë°°ê²½ìƒ‰ ë³€ê²½ */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #333;
        }

        .container {
            background-color: white;
            padding: 2.5rem;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            text-align: center;
            width: 90%;
            max-width: 420px;
        }

        h1 { margin-top: 0; color: #4a4a4a; font-size: 1.8rem; margin-bottom: 0.5rem; }
        
        .status-bar {
            background-color: #f0f0f0;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 20px;
            font-weight: bold;
            color: #555;
            display: flex;
            justify-content: space-between;
        }

        .chances-left { color: #d9534f; }

        input[type="number"] {
            width: 70%;
            padding: 14px;
            font-size: 1.2rem;
            border: 2px solid #ddd;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 1rem;
            outline: none;
            transition: 0.3s;
        }
        input[type="number"]:focus { border-color: #fda085; }

        button {
            background-color: #fda085;
            color: white;
            border: none;
            padding: 14px 28px;
            font-size: 1.1rem;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            font-weight: bold;
            transition: 0.3s;
        }
        button:hover { background-color: #f6d365; color: #444; }
        button:disabled { background-color: #ccc; cursor: not-allowed; }

        .message {
            margin-top: 1.5rem;
            font-weight: bold;
            font-size: 1.1rem;
            min-height: 1.5em;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .hint { color: #007bff; }

        .history-box {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
            font-size: 0.9rem;
            color: #777;
            text-align: left;
        }
        .history-list {
            margin-top: 5px;
            font-family: monospace;
            font-size: 1.1rem;
            color: #333;
            word-break: break-all;
        }

        .restart-btn {
            background-color: #444;
            margin-top: 1rem;
            display: none; 
            color: white;
        }
        .restart-btn:hover { background-color: #222; color: white; }
    </style>
</head>
<body>

    <div class="container">
        <h1>ìˆ«ì ë§íˆê¸° ğŸ”¥</h1>
        
        <div class="status-bar">
            <span>ë²”ìœ„: 1 ~ 100</span>
            <span class="chances-left" id="chanceDisplay">ë‚¨ì€ ê¸°íšŒ: 5</span>
        </div>

        <input type="number" id="guessField" min="1" max="100" placeholder="ìˆ«ì ì…ë ¥">
        <button id="submitBtn" onclick="checkGuess()">í™•ì¸</button>
        
        <div class="message" id="message">ìˆ«ìë¥¼ ì…ë ¥í•˜ê³  í™•ì¸ì„ ëˆ„ë¥´ì„¸ìš”.</div>
        
        <div class="history-box">
            <div>ğŸ“œ ì…ë ¥í•œ ìˆ«ì ê¸°ë¡:</div>
            <div class="history-list" id="historyList">-</div>
        </div>

        <button class="restart-btn" id="restartBtn" onclick="resetGame()">ë‹¤ì‹œ ì‹œì‘í•˜ê¸°</button>
    </div>

    <script>
        // ê²Œì„ ìƒíƒœ ë³€ìˆ˜
        let randomNumber;
        let chances;
        let history = [];
        let isGameOver = false;

        const guessField = document.getElementById('guessField');
        const message = document.getElementById('message');
        const submitBtn = document.getElementById('submitBtn');
        const restartBtn = document.getElementById('restartBtn');
        const chanceDisplay = document.getElementById('chanceDisplay');
        const historyList = document.getElementById('historyList');

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰ (ì €ì¥ëœ ê²Œì„ì´ ìˆëŠ”ì§€ í™•ì¸)
        window.onload = function() {
            loadGame();
        };

        // ì—”í„°í‚¤ ì§€ì›
        guessField.addEventListener("keypress", function(event) {
            if (event.key === "Enter") checkGuess();
        });

        // 1. ê²Œì„ ë¶ˆëŸ¬ì˜¤ê¸° (localStorage)
        function loadGame() {
            const savedData = localStorage.getItem('numberGameSave');
            
            if (savedData) {
                // ì €ì¥ëœ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ë¶ˆëŸ¬ì˜´
                const data = JSON.parse(savedData);
                randomNumber = data.randomNumber;
                chances = data.chances;
                history = data.history;
                isGameOver = data.isGameOver;

                // í™”ë©´ ì—…ë°ì´íŠ¸
                updateUI();
                
                // ë§Œì•½ ë¶ˆëŸ¬ì˜¨ ê²Œì„ì´ ì´ë¯¸ ëë‚œ ìƒíƒœë¼ë©´ ì¢…ë£Œ ì²˜ë¦¬
                if (isGameOver) endGameUI(chances > 0); 
            } else {
                // ì €ì¥ëœ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ìƒˆ ê²Œì„ ì‹œì‘
                initNewGameData();
            }
        }

        // 2. ìƒˆ ê²Œì„ ë°ì´í„° ì´ˆê¸°í™”
        function initNewGameData() {
            randomNumber = Math.floor(Math.random() * 100) + 1;
            chances = 5;
            history = [];
            isGameOver = false;
            saveGame(); // ì´ˆê¸° ìƒíƒœ ì €ì¥
            updateUI();
            
            // UI ì´ˆê¸°í™”
            guessField.disabled = false;
            guessField.value = '';
            submitBtn.disabled = false;
            submitBtn.style.display = 'block';
            restartBtn.style.display = 'none';
            message.textContent = '1ë¶€í„° 100 ì‚¬ì´ì˜ ìˆ«ìë¥¼ ë§ì¶°ë³´ì„¸ìš”!';
            message.className = 'message';
            guessField.focus();
        }

        // 3. ì •ë‹µ í™•ì¸ ë¡œì§
        function checkGuess() {
            if (isGameOver) return;

            const userGuess = Number(guessField.value);

            // ìœ íš¨ì„± ê²€ì‚¬
            if (!userGuess || userGuess < 1 || userGuess > 100) {
                setMessage('1ë¶€í„° 100 ì‚¬ì´ì˜ ìˆ«ìë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!', 'error');
                return;
            }

            // ì´ë¯¸ ì…ë ¥í•œ ìˆ«ìì¸ì§€ í™•ì¸ (ì„ íƒ ì‚¬í•­)
            if (history.includes(userGuess)) {
                setMessage('ì´ë¯¸ ì…ë ¥í–ˆë˜ ìˆ«ìì…ë‹ˆë‹¤. ë‹¤ë¥¸ ìˆ«ìë¥¼ ì…ë ¥í•˜ì„¸ìš”.', 'error');
                return;
            }

            // ê¸°ë¡ ì¶”ê°€ ë° ê¸°íšŒ ì°¨ê°
            history.push(userGuess);
            chances--;

            // ê²°ê³¼ íŒë³„
            if (userGuess === randomNumber) {
                isGameOver = true;
                saveGame();
                updateUI();
                setMessage(`ğŸ‰ ì •ë‹µì…ë‹ˆë‹¤! ìˆ«ìëŠ” ${randomNumber}ì˜€ìŠµë‹ˆë‹¤.`, 'success');
                endGameUI(true);
            } else if (chances === 0) {
                isGameOver = true;
                saveGame();
                updateUI();
                setMessage(`ğŸ’€ ê²Œì„ ì˜¤ë²„! ì •ë‹µì€ ${randomNumber}ì˜€ìŠµë‹ˆë‹¤.`, 'error');
                endGameUI(false);
            } else {
                // íŒíŠ¸ ì œê³µ
                let hint = userGuess < randomNumber ? 'ì—… (UP) â–²' : 'ë‹¤ìš´ (DOWN) â–¼';
                setMessage(hint, 'hint');
                saveGame(); // ì§„í–‰ ìƒí™© ì €ì¥
                updateUI();
            }
            
            guessField.value = '';
            guessField.focus();
        }

        // 4. í™”ë©´ ì—…ë°ì´íŠ¸ (ê¸°íšŒ, íˆìŠ¤í† ë¦¬)
        function updateUI() {
            chanceDisplay.textContent = `ë‚¨ì€ ê¸°íšŒ: ${chances}`;
            if (history.length > 0) {
                historyList.textContent = history.join(', ');
            } else {
                historyList.textContent = '-';
            }
        }

        // 5. ê²Œì„ ì¢…ë£Œ UI ì²˜ë¦¬
        function endGameUI(isSuccess) {
            guessField.disabled = true;
            submitBtn.style.display = 'none';
            restartBtn.style.display = 'block';
        }

        // 6. ì¬ì‹œì‘ (ë°ì´í„° ì‚­ì œ ë° ì´ˆê¸°í™”)
        function resetGame() {
            localStorage.removeItem('numberGameSave'); // ì €ì¥ëœ ë°ì´í„° ì‚­ì œ
            initNewGameData();
        }

        // 7. ë©”ì‹œì§€ í‘œì‹œ í—¬í¼ í•¨ìˆ˜
        function setMessage(msg, type) {
            message.textContent = msg;
            message.className = 'message ' + type;
        }

        // 8. ë°ì´í„° ì €ì¥ (localStorage)
        function saveGame() {
            const gameState = {
                randomNumber: randomNumber,
                chances: chances,
                history: history,
                isGameOver: isGameOver
            };
            localStorage.setItem('numberGameSave', JSON.stringify(gameState));
        }
    </script>
</body>
</html>